import{j as e,r as s,R as W}from"./react-de000dcb.js";import{c as $}from"./react-dom-01bb03c2.js";import{L as T,B}from"./react-router-dom-ecf7b762.js";import{u as V,G as q,D as G,M as K}from"./@react-google-maps-9b96fd95.js";import{l as P}from"./socket.io-client-8eff3622.js";import{L as H}from"./react-chartjs-2-39834ffd.js";import{C as Y,a as U,b as J,P as Z,c as Q,p as X,d as ee,e as te}from"./chart.js-f60133a4.js";import{d as se,e as S}from"./react-router-772d0a10.js";import"./@remix-run-bd9b5cd5.js";import"./engine.io-client-f04dbd14.js";import"./engine.io-parser-b13552ae.js";import"./@socket.io-3e1df240.js";import"./socket.io-parser-44417fca.js";import"./@kurkle-36ca2f10.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))h(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&h(u)}).observe(document,{childList:!0,subtree:!0});function p(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function h(t){if(t.ep)return;t.ep=!0;const r=p(t);fetch(t.href,r)}})();function ae(){return e.jsx("header",{className:"bg-white shadow-md border-b border-gray-200",children:e.jsxs("nav",{className:"container mx-auto flex justify-between items-center py-4 px-6",children:[e.jsx(T,{to:"/",className:"text-[#001C58] text-2xl font-bold uppercase tracking-tight",children:"🚴 Dashboard Cyclisme"}),e.jsx("ul",{className:"flex space-x-6 text-[#001C58] text-lg",children:[{to:"/",label:"Accueil"},{to:"/trajet",label:"Trajet"},{to:"/consommation",label:"Votre impact"},{to:"/data",label:"Tableau de bord"}].map(({to:n,label:o},p)=>e.jsx("li",{children:e.jsx(T,{to:n,className:"hover:text-[#FFCD00] transition",children:o})},p))})]})})}function re(){return e.jsxs("div",{className:"container mx-auto p-10 text-[#4A4A4A]",children:[e.jsx("h1",{className:"text-4xl font-bold uppercase tracking-tight text-[#001C58] text-center mb-6",children:"🚴‍♂️ Tableau de Bord Cyclisme"}),e.jsx("p",{className:"text-center text-lg mb-10",children:"Suivez vos performances et données en temps réel avec précision."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[{to:"/trajet",label:"Trajet",desc:"Suivez votre itinéraire et votre progression."},{to:"/consommation",label:"Consommation Énergétique",desc:"Analysez l'énergie que vous générez."},{to:"/data",label:"Tableau de Bord",desc:"Consultez toutes vos métriques en temps réel."},{to:"/donnees-avancees",label:"Données Avancées",desc:"Explorez une analyse plus poussée."}].map(({to:n,label:o,desc:p},h)=>e.jsxs(T,{to:n,className:"bg-white p-6 rounded-lg shadow-md border border-gray-200 hover:border-[#FFCD00] transition",children:[e.jsx("h2",{className:"text-xl font-semibold text-[#001C58]",children:o}),e.jsx("p",{className:"text-gray-600",children:p})]},h))})]})}const ne="AIzaSyA2tP6W_4xsD-uOiqLb5Z_9743p-mb2L-I",oe={width:"100%",height:"500px",borderRadius:"12px"},le={lat:48.8566,lng:2.3522},ie="https://maps.gstatic.com/mapfiles/ms2/micons/cycling.png";function ce(){const{isLoaded:n}=V({googleMapsApiKey:ne,libraries:["geometry"]}),[o,p]=s.useState(null),[h,t]=s.useState(1),[r,u]=s.useState(null),[x,c]=s.useState(0),[g,m]=s.useState(""),[d,w]=s.useState("");s.useEffect(()=>{const l=P("http://localhost:5001");return l.on("metrics_update",v=>c(v.distance)),()=>l.close()},[]);const D=()=>{!g||!d||new window.google.maps.DirectionsService().route({origin:g,destination:d,travelMode:"BICYCLING"},(l,v)=>{v==="OK"&&(p(l),t(l.routes[0].legs.reduce((C,f)=>C+f.distance.value,0)),u(l.routes[0].legs[0].start_location))})};return s.useEffect(()=>{if(!o||x>=h)return;let l=x,v=o.routes[0].legs[0].start_location;for(const C of o.routes[0].legs)for(const f of C.steps){if(l<=f.distance.value){const N=l/f.distance.value;v=window.google.maps.geometry.spherical.interpolate(f.start_location,f.end_location,N);break}l-=f.distance.value}u(v)},[x,o]),n?e.jsxs("div",{className:"container mx-auto p-10 text-[#4A4A4A]",children:[e.jsx("h2",{className:"text-3xl font-bold uppercase tracking-tight text-[#001C58] text-center mb-6",children:"🚴 Suivi de votre Trajet"}),e.jsx("p",{className:"text-center text-lg mb-8",children:"Planifiez votre itinéraire et suivez votre progression en direct."}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4 mb-6",children:[e.jsx("input",{type:"text",placeholder:"Départ",className:"border border-gray-300 p-3 rounded-lg w-full md:w-1/2 focus:border-[#001C58]",onChange:l=>m(l.target.value)}),e.jsx("input",{type:"text",placeholder:"Arrivée",className:"border border-gray-300 p-3 rounded-lg w-full md:w-1/2 focus:border-[#001C58]",onChange:l=>w(l.target.value)}),e.jsx("button",{className:"bg-[#FFCD00] text-[#001C58] px-5 py-3 rounded-lg font-bold uppercase hover:bg-[#001C58] hover:text-white transition",onClick:D,children:"🚴 Planifier"})]}),e.jsx("div",{className:"bg-white p-6 shadow-md border border-gray-200 rounded-lg",children:e.jsxs(q,{mapContainerStyle:oe,zoom:12,center:le,children:[o&&e.jsx(G,{directions:o}),r&&e.jsx(K,{position:r,icon:ie})]})}),e.jsxs("div",{className:"bg-white p-6 shadow-md border border-gray-200 rounded-lg mt-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold uppercase text-[#001C58] mb-2",children:"📊 Progression"}),e.jsxs("p",{children:["🚴 Distance parcourue : ",x.toFixed(2)," m"]}),e.jsxs("p",{children:["📍 Distance totale : ",h.toFixed(2)," m"]})]})]}):e.jsx("p",{className:"text-[#001C58] text-center text-xl",children:"📍 Chargement de la carte..."})}const F=5,de=[{label:"☕ Café préparé",value:100},{label:"🍞 1 Toast grillé",value:250},{label:"📱 Téléphone chargé",value:500},{label:"💡 Ampoule LED (10h)",value:1e3},{label:"🚗 Voiture électrique (10 km)",value:2e3},{label:"🏡 Maison (1 jour)",value:5e3}],xe=[{threshold:1e3,icon:"🌱",title:"Semis plantés"},{threshold:2500,icon:"🌳",title:"Arbres replantés"},{threshold:5e3,icon:"🌲",title:"Don effectué"}];function me(){const[n,o]=s.useState({power:0,distance:0,revolutions:0}),[p,h]=s.useState(0),[t,r]=s.useState(0),[u,x]=s.useState([]),[c,g]=s.useState([]),[m,d]=s.useState(null),[w,D]=s.useState(0),[l,v]=s.useState(0),[C,f]=s.useState(0),[N,E]=s.useState("total"),L=s.useRef(0),A=s.useRef(null);s.useEffect(()=>{L.current=n.distance},[n.distance]),s.useEffect(()=>{const a=P("http://localhost:5001");return a.on("metrics_update",i=>{o(i);const j=2;r(b=>b+i.power*(j/3600))}),()=>a.close()},[]),s.useEffect(()=>{let a=Date.now(),i=L.current;const j=setInterval(()=>{const b=Date.now(),y=(b-a)/1e3,I=L.current,R=(I-i)/y*3.6;h(R),m&&A.current&&b-A.current>5e3&&R>C&&f(R),a=b,i=I},1e3);return()=>clearInterval(j)},[m,C]);const _=()=>{const a=prompt("Entrez le nom et prénom du participant:");a&&(d({name:a}),D(t),v(n.distance),f(0),A.current=Date.now())},O=()=>{if(!m)return;const a=t-w,i=[...u,{name:m.name,energy:a}].sort((b,y)=>y.energy-b.energy);x(i);const j=[...c,{name:m.name,speed:C}].sort((b,y)=>y.speed-b.speed);g(j),d(null)},k=Math.min(t/(F*1e3)*100,100),M=m?t-w:0,z=m?n.distance-l:0;return e.jsxs("div",{className:"container mx-auto p-6 text-[#4A4A4A]",children:[e.jsxs("header",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-4xl font-bold text-[#001C58]",children:"🚴 Événement Cyclisme"}),e.jsx("p",{className:"mt-2 text-lg",children:"Suivi en direct de vos performances"})]}),e.jsxs("div",{className:"flex justify-center mb-8",children:[e.jsx("button",{onClick:()=>E("total"),className:`mx-2 px-4 py-2 rounded-lg font-bold ${N==="total"?"bg-[#001C58] text-white":"bg-gray-200 text-[#001C58]"}`,children:"Total"}),e.jsx("button",{onClick:()=>E("circuit"),className:`mx-2 px-4 py-2 rounded-lg font-bold ${N==="circuit"?"bg-[#001C58] text-white":"bg-gray-200 text-[#001C58]"}`,children:"Circuit"}),e.jsx("button",{onClick:()=>E("leaderboard"),className:`mx-2 px-4 py-2 rounded-lg font-bold ${N==="leaderboard"?"bg-[#001C58] text-white":"bg-gray-200 text-[#001C58]"}`,children:"Leaderboard"})]}),N==="total"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#001C58] mb-6",children:"⚡ Mesures Globales"}),e.jsxs("p",{className:"text-center text-lg",children:["Puissance Actuelle : ",e.jsxs("span",{className:"font-bold",children:[n.power," W"]})]}),e.jsxs("p",{className:"text-center text-lg",children:["Distance Totale : ",e.jsxs("span",{className:"font-bold",children:[n.distance.toFixed(2)," m"]})]}),e.jsxs("p",{className:"text-center text-lg",children:["Énergie Totale : ",e.jsxs("span",{className:"font-bold",children:[t.toFixed(2)," Wh"]})]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#001C58] mb-6",children:"🌍 Impact Collectif"}),e.jsxs("p",{className:"text-center mb-4 font-medium",children:["Objectif : ",F," kWh"]}),e.jsxs("div",{className:"relative h-8 bg-gray-300 rounded-full overflow-hidden",children:[e.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-blue-500 rounded-full transition-all duration-500",style:{width:`${k}%`}}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-lg font-bold text-[#001C58]",children:[k.toFixed(0),"%"]})]}),e.jsxs("p",{className:"mt-4 text-center font-semibold",children:[t.toFixed(2)," Wh produits"]}),e.jsx("div",{className:"flex justify-around mt-6",children:xe.map((a,i)=>{const j=a.threshold/(F*1e3)*100,b=t>=a.threshold;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`text-3xl ${b?"opacity-100":"opacity-50"}`,children:a.icon}),e.jsx("div",{className:"text-xs font-medium text-[#001C58]",children:a.title}),e.jsxs("div",{className:"text-xs text-gray-600",children:[j.toFixed(0),"%"]})]},i)})})]})]}),N==="circuit"&&e.jsx("div",{className:"grid grid-cols-1 gap-8",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#001C58] mb-6",children:"🏎 Mode Circuit"}),m?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-center mb-6",children:["Bonjour ",e.jsx("span",{className:"font-bold",children:m.name})," !",e.jsx("br",{}),"Vous avez produit"," ",e.jsxs("span",{className:"font-bold",children:[M.toFixed(2)," Wh"]})," durant cette session."]}),e.jsxs("p",{className:"text-center mb-6",children:["Distance parcourue :"," ",e.jsxs("span",{className:"font-bold",children:[z.toFixed(2)," m"]})]}),e.jsx("div",{className:"text-center mb-6",children:e.jsxs("p",{className:"text-xl font-bold text-[#001C58]",children:["Vitesse Actuelle : ",p.toFixed(2)," km/h"]})}),e.jsx("div",{className:"space-y-4",children:de.map((a,i)=>{const j=Math.min(M/a.value*100,100);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-[#001C58] font-medium",children:a.label}),e.jsxs("span",{className:"text-sm text-gray-600",children:[a.value," Wh"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-[#FFCD00] h-4 rounded-full transition-all duration-500",style:{width:`${j}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-600",children:[j.toFixed(0),"%"]})]},i)})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:O,className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-bold uppercase transition-colors",children:"🛑 Terminer la session"})})]}):e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Démarrez une session pour suivre vos performances."}),e.jsx("button",{onClick:_,className:"px-6 py-3 bg-[#001C58] hover:bg-blue-900 text-white rounded-lg font-bold uppercase transition-colors",children:"🚴 Démarrer la session"})]})]})}),N==="leaderboard"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-10",children:[e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#001C58] mb-6",children:"🏁 Leaderboard des Vitesses"}),c.length>0?e.jsx("ol",{className:"list-decimal list-inside space-y-2",children:c.slice(0,5).map((a,i)=>e.jsxs("li",{className:"text-xl text-[#001C58] font-medium",children:[a.name," - ",a.speed.toFixed(2)," km/h"]},i))}):e.jsx("p",{className:"text-center text-gray-600",children:"Aucune vitesse enregistrée pour l’instant..."})]}),e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg border border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#001C58] mb-6",children:"🏆 Leaderboard Énergie Produite"}),u.length>0?e.jsx("ol",{className:"list-decimal list-inside space-y-2",children:u.slice(0,5).map((a,i)=>e.jsxs("li",{className:"text-xl text-[#001C58] font-medium",children:[i+1,". ",a.name," - ",a.energy.toFixed(2)," Wh"]},i))}):e.jsx("p",{className:"text-center text-gray-600",children:"Aucun participant pour l’instant..."})]})]})]})}Y.register(U,J,Z,Q,X,ee,te);const ue=3.3,pe=2.1,he=2;function ge(){const[n,o]=s.useState({power:0,cadence:0,distance:0,revolutions:0,speed:0}),[p,h]=s.useState({labels:[],datasets:[{label:"Puissance (W)",data:[],borderColor:"#FFCD00",backgroundColor:"rgba(255,205,0,0.2)"},{label:"Cadence (RPM)",data:[],borderColor:"#001C58",backgroundColor:"rgba(0,28,88,0.2)"},{label:"Vitesse (km/h)",data:[],borderColor:"#000000",backgroundColor:"rgba(0,0,0,0.2)"}]}),t=s.useRef(null),r=s.useRef(!0);s.useEffect(()=>{const x=P("http://localhost:5001");return x.on("metrics_update",c=>{let g=0;r.current?r.current=!1:g=(c.revolutions-t.current)*ue*pe/he*3.6,t.current=c.revolutions;const m={...c,speed:g};o(m),h(d=>({labels:[...d.labels,new Date().toLocaleTimeString()].slice(-30),datasets:[{...d.datasets[0],data:[...d.datasets[0].data,Math.abs(c.power)].slice(-30)},{...d.datasets[1],data:[...d.datasets[1].data,c.cadence].slice(-30)},{...d.datasets[2],data:[...d.datasets[2].data,g].slice(-30)}]}))}),()=>x.close()},[]);const u=[{icon:"⚡",label:"Puissance",value:`${Math.abs(n.power)} W`},{icon:"🚴",label:"Cadence",value:`${n.cadence} RPM`},{icon:"📏",label:"Distance",value:`${n.distance.toFixed(2)} m`},{icon:"🏎️",label:"Vitesse",value:`${n.speed.toFixed(2)} km/h`}];return e.jsxs("div",{className:"container mx-auto p-10 text-[#4A4A4A]",children:[e.jsx("h2",{className:"text-3xl font-bold uppercase tracking-tight text-[#001C58] text-center mb-6",children:"📊 Données en Temps Réel"}),e.jsx("p",{className:"text-center text-lg mb-8",children:"Consultez en direct l'évolution de votre puissance, cadence et vitesse."}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-6",children:u.map((x,c,g)=>e.jsxs("div",{className:`bg-white p-6 shadow-md border border-gray-200 rounded-lg text-center ${g.length%3===1&&c===g.length-1?"lg:col-start-2":""}`,children:[e.jsxs("h3",{className:"text-lg font-semibold text-[#001C58] uppercase",children:[x.icon," ",x.label]}),e.jsx("p",{className:"text-2xl",children:x.value})]},c))}),e.jsxs("div",{className:"bg-white p-6 shadow-md border border-gray-200 rounded-lg mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold uppercase text-[#001C58] mb-4",children:"📉 Évolution des Données"}),e.jsx(H,{data:p})]})]})}const be=()=>e.jsxs(B,{children:[e.jsx(ae,{}),e.jsx("div",{className:"min-h-screen bg-gray-100",children:e.jsxs(se,{children:[e.jsx(S,{path:"/",element:e.jsx(re,{})}),e.jsx(S,{path:"/trajet",element:e.jsx(ce,{})}),e.jsx(S,{path:"/consommation",element:e.jsx(me,{})}),e.jsx(S,{path:"/data",element:e.jsx(ge,{})})]})})]});$.createRoot(document.getElementById("root")).render(e.jsx(W.StrictMode,{children:e.jsx(be,{})}));
